context("test-fix_na_lon_na_lat")

test_that("Checks if  the cases with LONGITUDE is NA and LATITUDE is NA, are corrected.", {

  id <-c(9752L, 31L, 10058L, 8179L, 7261L, 9952L, 6016L, 6015L, 5948L,
         6697L, 9790L, 6878L, 9800L, 6879L, 1056L, 9892L, 6880L, 6881L,
         7264L, 7263L, 7262L, 1268L, 6882L, 1624L, 6076L, 8261L, 10012L,
         6067L, 10061L, 10062L, 10154L, 10210L, 7787L, 7790L, 7791L, 10060L,
         10023L, 6306L, 10009L, 9914L, 9912L, 10053L, 6554L, 6577L, 6266L,
         10214L, 6639L, 6379L, 7775L)

  year <- c(-223L, -177L, 551L, 857L, 1118L, 1269L, 1332L, 1403L, 1489L,
            1500L, 1537L, 1576L, 1651L, 1659L, 1669L, 1681L, 1707L, 1719L,
            1732L, 1734L, 1734L, 1737L, 1798L, 1817L, 1839L, 1842L, 1848L,
            1852L, 1865L, 1865L, 1866L, 1870L, 1870L, 1870L, 1871L, 1876L,
            1877L, 1878L, 1881L, 1885L, 1885L, 1897L, 1903L, 1912L, 1916L,
            1919L, 1932L, 1957L, 1978L)

  month <- c(10L, NA, 4L, 4L, NA, NA, 2L, 11L, NA, NA, NA, 5L, NA, 9L, 6L,
             12L, NA, NA, NA, NA, NA, 10L, 2L, 4L, 3L, 11L, 10L, 11L, 3L,
             3L, 1L, 6L, 8L, 11L, 1L, 10L, 2L, 1L, 11L, 1L, 1L, 9L, 9L, 12L,
             1L, 8L, 11L, 11L, 6L)

  day <- c(NA, NA, NA, NA, NA, NA, 12L, 16L, NA, NA, NA, 23L, NA, 30L,
           4L, 11L, NA, NA, NA, NA, NA, 11L, 2L, NA, NA, 1L, 17L, 25L, 1L,
           1L, 19L, 9L, 6L, 2L, 17L, 26L, 24L, 20L, 24L, 25L, 29L, 21L,
           7L, 6L, 31L, 19L, 10L, NA, 22L)

  country <- c("GREECE", "ITALY", "GREECE", "EGYPT", "UK", "TURKEY", "TURKEY",
               "SYRIA", "TURKEY", "USA", "MEXICO", "EL SALVADOR", "PERU", "EL SALVADOR",
               "INDIA", "INDONESIA", "EL SALVADOR", "EL SALVADOR", "ICELAND",
               "ICELAND", "UK", "INDIA", "EL SALVADOR", "CHINA", "USA", "CANADA",
               "NEW ZEALAND", "USA", "JAPAN", "PERU", "GREECE", "GUADELOUPE",
               "CROATIA", "ITALY", "ITALY", "JAPAN", "USA", "USA", "TONGA",
               "ICELAND", "ALGERIA", "NEW ZEALAND", "TAIWAN", "MICRONESIA, FED. STATES OF",
               "COSTA RICA", "VENEZUELA", "USA", "SOLOMON ISLANDS", "ITALY")

  loc <- c("GREECE", "ITALY:  SABINES", "GREECE:  MALIAKOS GULF", "EGYPT",
           "UNITED KINGDOM:  IRELAND:  SLIABH-ELPA", "TURKEY:  CICILIA, CEYHAN (SEYHAN)",
           "MARMARA SEA", "SYRIAN COASTS", "SOUTH COASTS OF ASIA MINOR",
           "HAWAII", "MEXICO:  SOUTHERN", "EL SALVADOR:  SAN MARCOS", "PERU-CHILE",
           "EL SALVADOR:  SAN SALVADOR", "INDIA:  FORT MADRAN", "INDONESIA:  SUMATRA:  MENTAWAI ISLANDS",
           "EL SALVADOR:  SAN SALVADOR", "EL SALVADOR:  SAN SALVADOR", "ICELAND:  SOUTHERN LOWLAND",
           "ICELAND:  SOUTHERN LOWLAND", "UNITED KINGDOM:  IRELAND", "INDIA:  CALCUTTA",
           "EL SALVADOR:  SAN SALVADOR", "CHINA:  SICHUAN PROVINCE:  CHANGLI",
           "HAWAII", "CANADA:  MONTREAL", "NEW ZEALAND:  COOK STRAIT", "CALIFORNIA:  NORTHERN",
           "JAPAN:  RYUKYU ISLANDS", "PERU:  CALLAO", "GREECE:  AEGEAN SEA",
           "GUADELOUPE", "GREECE:  CRETE", "ITALY:  CALABRIA", "ITALY:  LIGURIAN COAST",
           "JAPAN:  RYUKYU ISLANDS", "HAWAII", "ALASKA:  ALEUTIAN ISLANDS",
           "TONGA ISLANDS", "ICELAND", "ALGERIA:  BORDJOU, ARRERIDJ", "NEW ZEALAND: WELLINGTON",
           "TAIWAN", "MICRONESIA, FED. STATES OF:  YAP IS, CAROLINE IS",
           "COSTA RICA-PANAMA", "LARA", "NEW YORK:  WILLETTS POINT", "SOLOMON ISLANDS",
           "ITALY:  ADRIATIC SEA")


  long <- NA_real_
  lat <-  NA_real_

  df <- data.frame(I_D=id, YEAR=year, MONTH=month, DAY=day,
                   COUNTRY=country, LOCATION_NAME=loc,
                   LATITUDE=lat, LONGITUDE=long, stringsAsFactors = FALSE)

  month_res <- c(10, NA, 4, 4, NA, NA, 2, 11, NA, NA, NA, 5, NA, 9, 6, 12, NA,
                 NA, 9, 3, NA, 10, 2, 4, 3, 11, 10, 11, 3, 3, 1, 6, 8, 11, 1,
                 10, 2, 1, 11, 1, 1, 9, 9, 12, 1, 8, 11, 11, 6)

  day_res <- c(NA, NA, NA, NA, NA, NA, 12, 16, NA, NA, NA, 23, NA, 30, 4,
               11, NA, NA, 7, 21, NA, 11, 2, NA, NA, 1, 17, 25, 1, 1, 19, 9,
               6, 2, 17, 26, 24, 20, 24, 25, 29, 21, 7, 6, 31, 19, 10, NA, 22)

  country_res <- c("GREECE", "ITALY", "GREECE", "EGYPT", "UK", "TURKEY", "TURKEY",
               "SYRIA", "TURKEY", "USA", "MEXICO", "EL SALVADOR", "PERU", "EL SALVADOR",
               "PAKISTAN", "INDONESIA", "EL SALVADOR", "EL SALVADOR", "ICELAND",
               "ICELAND", "UK", "INDIA", "EL SALVADOR", "CHINA", "USA", "CANADA",
               "NEW ZEALAND", "USA", "JAPAN", "PERU", "GREECE", "GUADELOUPE",
               "CROATIA", "ITALY", "ITALY", "JAPAN", "USA", "USA", "TONGA",
               "ICELAND", "ALGERIA", "NEW ZEALAND", "TAIWAN", "MICRONESIA, FED. STATES OF",
               "COSTA RICA", "VENEZUELA", "USA", "SOLOMON ISLANDS", "ITALY")

  loc_res <- c("GREECE", "ITALY:  SABINES", "GREECE:  MALIAKOS GULF", "EGYPT",
               "UNITED KINGDOM:  IRELAND:  SLIABH-ELPA", "TURKEY:  CICILIA, CEYHAN (SEYHAN)",
               "MARMARA SEA", "SYRIAN COASTS", "SOUTH COASTS OF ASIA MINOR",
               "HAWAII", "MEXICO:  SOUTHERN", "EL SALVADOR:  SAN MARCOS", "PERU-CHILE",
               "EL SALVADOR:  SAN SALVADOR", "Mandra", "INDONESIA:  SUMATRA:  MENTAWAI ISLANDS",
               "EL SALVADOR:  SAN SALVADOR", "EL SALVADOR:  SAN SALVADOR", "Rangarvellir",
               "Arnessysla", "UNITED KINGDOM:  IRELAND", "INDIA:  CALCUTTA",
               "EL SALVADOR:  SAN SALVADOR", "CHINA:  SICHUAN PROVINCE:  CHANGLI",
               "HAWAII", "CANADA:  MONTREAL", "NEW ZEALAND:  COOK STRAIT", "CALIFORNIA:  NORTHERN",
               "JAPAN:  RYUKYU ISLANDS", "PERU:  CALLAO", "GREECE:  AEGEAN SEA",
               "GUADELOUPE", "GREECE:  CRETE", "ITALY:  CALABRIA", "ITALY:  LIGURIAN COAST",
               "JAPAN:  RYUKYU ISLANDS", "HAWAII", "ALASKA:  ALEUTIAN ISLANDS",
               "TONGA ISLANDS", "ICELAND", "ALGERIA:  BORDJOU, ARRERIDJ", "NEW ZEALAND: WELLINGTON",
               "TAIWAN", "MICRONESIA, FED. STATES OF:  YAP IS, CAROLINE IS",
               "COSTA RICA-PANAMA", "LARA", "NEW YORK:  WILLETTS POINT", "SOLOMON ISLANDS",
               "ITALY:  ADRIATIC SEA")

  lat_res <- c(39.074208, 43.2010384, 38.8085709, 26.820553, 54.78771, 37.5,
               40.6681407, 35.25, 38.5472263, 19.8967662, 39.60183, 13.6609515,
               -33.5389815, 13.6929403, 33.4, -1.426001, 13.6929403, 13.6929403,
               63.8417, 64.25, 53.1423672, 22.572646, 13.6929403, 30.535311,
               19.8967662, 45.5016889, -41.340991, 38.8375215, 26.5, -12.0508491,
               39.019184, 16.265, 35.240117, 39.3087714, 44.3167917, 26.5, 19.8967662,
               54.4799849, -18.764052, 64.963051, 36.0704188, -41.2864603, 23.69781,
               9.5556503, 10.5771919, 10.1537842, 40.7606911, -9.64571, 41.8550904)

  long_res <- c(21.824312, 10.5394382, 22.7867174, 30.802498, -6.492314, 35.5,
                28.1122679, 36.1, -121.2386632, -155.5827818, -76.94416, -89.1729807,
                -70.5860382, -89.2181911, 73.3, 98.9245343, -89.2181911, -89.2181911,
                -20.2554, -20.5, -7.6920536, 88.363895, -89.2181911, 105.420744,
                -155.5827818, -73.567256, 174.3121264, -120.8958242, 128, -77.1259843,
                25.268555, -61.551, 24.8092691, 16.3463791, 8.3964938, 128, -155.5827818,
                -164.5534196, -174.019325, -19.020835, 4.7564046, 174.776236,
                120.960515, 138.1399232, -85.6550471, -69.8597406, -73.840436,
                160.156194, 17.2902839)

  df_res <- data.frame(I_D=id, YEAR=year, MONTH=month_res, DAY=day_res,
                   COUNTRY=country_res, LOCATION_NAME=loc_res,
                   LATITUDE=lat_res, LONGITUDE=long_res, stringsAsFactors = FALSE)

  testthat::expect_equal(fix_na_lon_na_lat(df), df_res)
})


